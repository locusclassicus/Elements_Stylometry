---
title: "R для антиковедов <br/> Модуль 3 "
subtitle: "Биномиальное распределение"  
author: 
  - "Ольга Алиева"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
	echo = TRUE,
	fig.height = 3.5,
	fig.retina = 3,
	fig.width = 9,
	message = FALSE,
	warning = FALSE,
	cache = FALSE,
	hiline = TRUE,
	out.width = "100%"
)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_light(
)
```

---
class: center, middle
# Биномиальное распределение

.pull-left[
<img src="https://c.tenor.com/tewn7lzVDgcAAAAC/coin-flip-flip.gif" style="width: 74%" />
]

.pull-right[
<img src="https://dataintegration.info/wp-content/uploads/2021/06/manufacturing-cwVEwL.gif" style="width: 100%" />
]

.footnote[Источник: Dataintegration.info]


---
# Требования к данным

- Каждое испытание имеет два взаимоисключающих исхода. 

- Каждое испытание должно быть независимо. 

- Вероятность p одинакова для всех испытаний. 

- Число испытаний определено и обозначается как n. 

---
# Формула  

<img src="https://chrispiech.github.io/probabilityForComputerScientists/img/chapters/binEquation2.png"style="width: 80%" />
]

.pull-right[
.footnote[Источник: [Chrispiech.github.io](https://chrispiech.github.io/probabilityForComputerScientists/en/part2/binomial/)]
]

---

# Серия испытаний Бернулли

> В серии из n испытаний Бернулли вероятность элементарного события, в котором определенным образом чередуются k успехов и n-k неудач, равна (p^k) * (q^(n-k)) <br/>

<br/>

| УУУ | УУН | УНУ | УНН | НУУ | ННУ | НУН | ННН |
| --- |-----|-----|-----|-----|-----|-----|-----|
|p^3  |p^2q |p^2q |pq^2 |p^2q |pq^2 |pq^2 |q^3  |

<br/>

```{r}
(0.5^3) * (0.5^0)
dbinom(3, 3, 0.5)
```

---

# Серия испытаний Бернулли

> В серии из n испытаний Бернулли вероятность элементарного события, в котором определенным образом чередуются k успехов и n-k неудач, равна (p^k) * (q^(n-k)) <br/>

<br/>

| УУУ | УУН | УНУ | УНН | НУУ | ННУ | НУН | ННН |
| --- |-----|-----|-----|-----|-----|-----|-----|
|p^3  |p^2q |p^2q |pq^2 |p^2q |pq^2 |pq^2 |q^3  |

<br/>

```{r}
(0.5^3) * (0.5^0) #<<
dbinom(3, 3, 0.5)
```

---
# Серия испытаний Бернулли

> В серии из n испытаний Бернулли вероятность элементарного события, в котором определенным образом чередуются k успехов и n-k неудач, равна (p^k) * (q^(n-k)) <br/>

<br/>

| УУУ | УУН | УНУ | УНН | НУУ | ННУ | НУН | ННН |
| --- |-----|-----|-----|-----|-----|-----|-----|
|p^3  |p^2q |p^2q |pq^2 |p^2q |pq^2 |pq^2 |q^3  |

<br/>

```{r}
(0.5^3) * (0.5^0) 
dbinom(3, 3, 0.5) #<<
```
---

# Серия испытаний Бернулли

> В серии из n испытаний Бернулли вероятность элементарного события, в котором определенным образом чередуются k успехов и n-k неудач, равна (p^k) * (q^(n-k)) <br/>

<br/>

| УУУ | УУН | УНУ | УНН | НУУ | ННУ | НУН | ННН |
| --- |-----|-----|-----|-----|-----|-----|-----|
|p^3  |p^2q |p^2q |pq^2 |p^2q |pq^2 |pq^2 |q^3  |

<br/>

```{r}
(0.5^2) * (0.5^1)
dbinom(2, 3, 0.5) #<<
```
---

# Количество сочетаний

<img src="https://qph.cf2.quoracdn.net/main-qimg-8d9ec9ea0aa49b4d96205d92777bb0df-lq" style="width: 60%" />

.footnote[Источник: [Quora.com](https://www.quora.com/How-many-combination-of-6-numbers-can-you-make-from-49-numbers-if-they-are-1-to-49)]


---

# Количество сочетаний

.pull-left[
<img src="https://qph.cf2.quoracdn.net/main-qimg-8d9ec9ea0aa49b4d96205d92777bb0df-lq" style="width: 100%" />

.footnote[Источник: [Quora.com](https://www.quora.com/How-many-combination-of-6-numbers-can-you-make-from-49-numbers-if-they-are-1-to-49)]
]

.pull-right[
```{r}
comb <- function(n,k) {
  factorial(n) / (factorial(k)*factorial(n-k))
}
comb(3, 2)
```
]
---
# Формула Бернулли

.pull-left[
<img src="https://chrispiech.github.io/probabilityForComputerScientists/img/chapters/binEquation2.png"style="width: 100%" />

.footnote[Источник: [Chrispiech.github.io](https://chrispiech.github.io/probabilityForComputerScientists/en/part2/binomial/)]
]

.pull-right[
```{r}
(0.5^2)*(0.5^1)*comb(3, 2)
dbinom(2, 3, 0.5)
```
]
---

# График
```{r echo=FALSE}
par(mfrow = c(1, 3))
success1 <- 0:20
plot(success1,dbinom(success1,size=20,prob=.3),
     type='h',
     main='n=20, p=0.3',
     ylab='Probability',
     xlab ='# Successes',
     lwd=3)
success2 <- 0:10
plot(success2, dbinom(success2, size=10, prob =.5),
     type='h',
     main='n=10, p=0.5',
     ylab='Probability',
     xlab ='# Successes',
     lwd=3)
success3 <- 0:40
plot(success3, dbinom(success3, size=40, prob =.1),
     type='h',
     main='n=40, p=0.1',
     ylab='Probability',
     xlab ='# Successes',
     lwd=3)
```
---
# Кумулятивная функция распределения 
.pull-left[
```{r}
dbinom(0, 3, 0.5) + dbinom(1, 3, 0.5) + 
  dbinom(2, 3, 0.5)
pbinom(2, 3, 0.5)
```
]

---
# Кумулятивная функция распределения 
.pull-left[
```{r}
dbinom(0, 3, 0.5) + dbinom(1, 3, 0.5) + 
  dbinom(2, 3, 0.5)
pbinom(2, 3, 0.5)
```
]

.pull-right[
```{r echo=FALSE}
library(dplyr)
library(ggplot2)

## What is the probability of >=2 heads in 3 coin flips where probability of heads is 0.5?
data.frame(heads = 0:3, 
           pmf = dbinom(x = 0:3, size = 3, prob = 0.5),
           cdf = pbinom(q = 0:3, size = 3, prob = 0.5, 
                        lower.tail = TRUE)) %>%
  mutate(Heads = ifelse(heads <= 2, "<=2", "other")) %>%
  ggplot(aes(x = factor(heads), y = cdf, fill = Heads)) +
  geom_col() +
  geom_text(
    aes(label = round(cdf,2), y = cdf + 0.01),
    size = 3,
    vjust = 0
  ) +
  labs(title = "Probability of X <= 2 successes",
       x = "Successes (x)",
       y = "probability") 
```
]

---
# Rbinom() & qbinom

```{r}
qbinom(0.87, 3, 0.5)
rbinom(20, 1, 0.5)
rbinom(20, 2, 0.5)
```


---

# Источники и литература:

- Бослаф С. Статистика для всех. Москва, 2017.

- Математическая вертикаль. Теория вероятностей и статистика. 7-9 классы. Под ред. И.В. Ященко. Москва, 2020.

- Baayen H. Analyzing Linguistic Data: A Practical Introduction to Statistics using R. CUP, 2008. 

---

class: center, middle

# Спасибо за внимание!

Slides created via the R packages:

[**xaringan**](https://github.com/yihui/xaringan)<br>
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer)

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
